# チーム別 Runbook（PMコメントでトリガー実行）

本書は A/B/C チームの定常タスクとトリガー例をまとめたものです。PM がチャットで「作業実行してください」とコメントし、対象タスク番号を指定すれば着手できるようにしています。

## 共通ルール
- Run ID 書式を厳守: `local-chrono2d-YYYYMMDD-XX` / `#<ID> (chrono-main)` / `#<ID> (Chrono C)`。
- 共有フォーマット（ワンライナー例）:  
  `Run local-chrono2d-20251118-01 / Artifact chrono-2d/artifacts/kkt_descriptor_actions_local.csv`  
  必要に応じてログ/Envパスも併記。  
- リンクチェック: `python scripts/check_doc_links.py <対象md...>` を更新後に実行し、結果をチャットに貼る。  
- 生成物（artifacts/*.csv, テストバイナリ）はコミットしない。サンプルCSVは必要に応じて含めるが、更新有無を明示する。  
- Changelog追記: ドキュメント/テンプレ/Runbook更新時は `docs/documentation_changelog.md` に記録。

## トリガー例
- PMコメント例: `@A-team 実行: A1-A3` / `@B-team 実行: B5,B7` / `@C-team 実行: C2,C4`  
- 報告フォーマット（チャット）:  
  - 実行タスク: A1/A2/...  
  - コマンド/結果サマリ（テキストでOK）  
  - Run ID / Artifact / Log パス  
  - `git status` 概要と生成物有無  
  - リンクチェック結果（実行した場合）
- 完了報告は `docs/team_status.md` の自チームセクションのみを編集して追記する（他セクションは触らない）。

## 次の実行指示（PM 発出済み）
- Aチーム: `@A-team 実行: A5,A8,A12`  
  例題データセット外部定義化、警告/リファクタ整理、ベンチ可視化仕上げを優先。
- Bチーム: `@B-team 実行: B3,B6,B15`  
  Run ID 自動反映の本番化、成果物最小化ポリシー適用、チャット共有テンプレ更新を優先。
- Cチーム: `@C-team 実行: C4,C12,C20`  
  条件数/ピボット解説の再構成、ドキュメントのフォーマット統一＆簡易Lint、Changelog 運用強化の明文化を実施。

## 自動実行キュー（長尺バッチ指示）
- Aチームバッチ: `@A-team 実行: A5-A12`  
  例題データ外部化→警告/リファクタ→可視化仕上げまで連続実行。ベンチ/回帰は warn-only→fail モードで 2 周回し、`git status` と生成物有無を各周で報告。
- Bチームバッチ: `@B-team 実行: B3,B6,B8,B15,B16,B17,B18`  
  Run ID 自動反映→成果物最小化→週次レポート/テンプレ更新→容量監視→安定/実験ワークフロー整備→ベンチ drift アラート強化を一括実施。cron/dispatch 両系でレポートを生成し、Artifacts の保持日数と head CSV を確認。外部CI実行不可の環境では実行をスキップし、「未実施（外部CI不可）」と明記した報告枠・テンプレ整備のみを行う。
- Cチームバッチ: `@C-team 実行: C4,C6,C9,C12,C15,C20`  
  条件数/ピボット解説再構成→リンク/整合チェック導線→CSV スキーマとサンプル整備→フォーマット統一/Lint→CI/運用導線整備→Changelog トリガー明文化をまとめて実施。更新後は `docs/documentation_changelog.md` に追記し、必要なら `scripts/check_doc_links.py <更新md>` を実行（存在しない場合は未実行と明記）。
- 実行・報告ルール: 全チームとも周回単位で結果を記録し、Run ID/Artifact/Log パス、`git status`、生成物有無、リンクチェック結果をセットで提出。長尺実行で中断が入る場合は途中経過を team_status.md にメモして継続可とする。

## 次の実行指示（長時間自走モード・多タスク束ね）
- Aチーム: `@A-team 実行: A3,A5-A10,A12,A13,A14,A17,A18`  
  warn-only→fail の2周を必須。複合拘束/感度/ログ粒度/ベンチ上限をまとめて回し、cond/pivot と drift をチェック。各周で Run ID を付与し、`artifacts/*.csv` はコミットせず head/summary を報告。
- Bチーム: `@B-team 実行: B3,B6,B8,B10,B15,B16,B17,B18,B20`  
  dispatch/cron 両系を連続実行し、Run ID 自動反映・Artifacts 最小化・週次レポート生成・容量監視・fail-on-drift 運用・YAML 共通化まで一気に進める。各周で head CSV + report.md + env/log tail を最小構成で残す。
- Cチーム: `@C-team 実行: C3,C4,C6,C8,C9,C11,C12,C15,C18,C20`  
  Run ID 貼付テンプレ→条件数/ピボット解説刷新→リンク/整合チェック導線→OpenMP/3D 方針強調→CSV スキーマ＆サンプル整備→命名/表記ガイド→Changelog トリガー明文化までを連続実行。更新ごとに `scripts/check_doc_links.py <更新md>` があれば実行し結果を記録。
- 報告: 長尺バッチの各周で Run ID/Artifact/Log パス、`git status`、生成物有無、リンクチェック結果（実行した場合）を team_status.md に追記し、チャットへも共有。

## 15分自走スプリント指示（短時間でもタスク多め）
- Aチーム: `@A-team 実行: A5,A8,A12,A14,A17`  
  例題外部化リストをタスク票化し、警告/リファクタ対象のフラグ一覧を整理。`tools/compare_bench_csv.py` で warn-only 1周を回し CSV head/summary を取得し、ベンチ上限/cond 逸脱を確認。ログ粒度設定の候補をまとめ、報告に Run ID/生成物有無を記載。
- Bチーム: `@B-team 実行: B3,B6,B8,B15,B16`  
  Run ID 自動反映テンプレを最新化し、Artifacts 最小構成（head CSV / report.md / env / log tail）を確認。チャット共有テンプレのサンプル文（成功/未実施/失敗）を用意。CI 実行不可の場合は「未実施（外部CI不可）」と明記した報告枠を team_status に追記し、容量監視/retention 方針と drift チェック結果欄をチェックリスト化。YAML 共通化の候補ステップを安定/実験ごとに列挙して適用順を提示。作業時間目安は 15 分超を想定。
- Cチーム: `@C-team 実行: C3,C4,C6,C9,C12,C15`  
  Run ID 貼付ワンライナーと条件数/ピボット解説を更新し、リンク/整合チェック導線を README/hand-off に反映。CSV スキーマとサンプルの差分を確認し、フォーマット統一/Lint コマンド（check_doc_links）の結果を team_status に記録。Changelog トリガーを短文化。
- 報告: 各チームとも 15 分内で実行できる範囲を優先し、`team_status.md` に実行タスク、Run ID（未取得なら理由）、生成物有無、`git status` 概要、リンクチェック結果を追記する。タスクは複数束ねた前提で「指示が少ない」状況ではなく、3 分以内に終わる想定でもない。さらに積み増す場合は具体タスクを明記したうえで PM に相談する。

## 次の実行指示（15分以上・実作業中心）
- Aチーム: `@A-team 実行: A5,A8,A12,A14,A17`  
  1) A5 外部化候補をタスク票化（入出力パス/サンプルCSV/JSON/チェック項目まで明記）。  
  2) A8 警告フラグを反映してビルドし、警告ログを収集して優先度付け（上位3件は修正方針まで）。  
  3) A12 ベンチを warn-only→fail の2周回し、`compare_bench_csv.py --previous data/bench_baseline.csv artifacts/bench_constraints.csv` の結果と head/summary を記録（Artifactsはコミットしない）。  
  4) A14/A17 閾値・ログ粒度・時間上限の具体設定案をまとめる。  
- Bチーム: `@B-team 実行: B3,B6,B8,B15,B16,B17`  
  外部CI不可なら「未実施（外部CI不可）」を明記しつつ、チャット共有テンプレ（成功/未実施/失敗）を完成形にし、容量監視/retention チェックリストを確定。YAML 共通化の適用順と差分影響を整理し、実行時に埋める Run ID/Artifact/Log 欄を team_status に用意。  
- Cチーム: `@C-team 実行: C3,C4,C6,C9,C12,C15`  
  条件数/ピボット解説を本文1節分書き換え、CSV スキーマ/サンプル差分の確認結果を記録。リンク/Lint 手順の実行結果を添付し、命名/表記ガイドの短文化と Changelog 追記まで実施。  
- 報告: 各チームとも 15 分超の実作業を実施し、`docs/team_status.md` に「実行タスク / Run ID / 生成物有無 / `git status` / リンクチェック結果」を追記する。

## Aチームタスク（実装/検証・長期）
1. OpenMP on/off 切替オプションをCLI化し、pivot/cond差分を自動比較するテストを追加。  
2. dump-json/verboseを拡張し、J行・入力パラメータ・異常系(NaN/Inf/pivot≈0)を最小再現JSONに出力。  
3. 摩擦スイープ端点と質量比1:100などストレスケースをデータセット化し、cond/pivot安定性を検証。  
4. ベンチスレッドスイープ(1/2/4/8)を本番化し、1.5x超を警告/失敗に切替可能に。  
5. 例題データセット拡充（JSON/CSV）で全拘束ケースを外部定義に移行。  
6. 新拘束タイプ追加テンプレート（構造体/J/テスト/ドキュメント）を作成。  
7. 決定性を保ちつつ近似誤差許容をケース別定義しテスト組込み。  
8. Lint/警告（-Wshadow/-Wconversion等）導入検討とリファクタリング。  
9. 手計算ミニケースを追加し期待pivot/condと厳密比較するテストを用意。  
10. 異常系ダンプ/復帰機構を整備し、失敗時に再現データと診断ログを残す。  
11. ケース生成スクリプト強化（パラメータスイープ、ベンチ/テスト入力自動生成）。  
12. ベンチ可視化スクリプトでcond/pivot分布と時間推移をグラフ化。  
13. 接触モデル改良（静摩擦緩衝帯、速度減衰パラメータ）を検証。  
14. 拘束パラメータ感度を調査し、許容レンジを見直す（外部データ更新）。  
15. ログ粒度を整理し最小/詳細切替を実装。  
16. Makefile依存自動列挙とターゲット整理（test/schema/bench分離）。  
17. ベンチ/テスト実行時間の記録と上限設定で逸脱警告を追加。  
18. 複合拘束ケースを追加し相互干渉によるcond/pivot劣化を検証。  
19. データセットのバージョン管理ルールを策定し、テストで対応版をチェック。  
20. constraints.md を最新結果・式・レンジで定期更新し、サンプルCSVを差し替える。

## Bチームタスク（CI/運用・長期）
1. chrono-2d CI安定化（本番/実験分離、dispatch/cron＋スキップタグ運用）。  
2. 拡張スキーマ（vn/vt/µs/µd/stick）チェックを本番運用し、欠落/異常値をfail。  
3. Run ID自動反映（README/ハンドオフ置換）の試験運用→本番化。  
4. ベンチジョブopt-in運用、1.5x超警告/失敗切替の設計。  
5. タイムアウト/リトライ導入とフレーク検証。  
6. 成果物最小化と保持期間設定（ログ/CSV/環境情報のみ）。  
7. スキップタグ運用ルール整備で無駄ジョブを削減。  
8. 週次cronレポート（テスト/ベンチサマリ）Artifacts化とチャット連携。  
9. ログ整形（tail＋タグ付け）と最小再現CSVアップロードを組込み。  
10. PR分割ガイドを実運用に落とし込み、段階CI適用を確立。  
11. 環境差異（OS/runner）記録と再現性ギャップ対策を文書化。  
12. ローカルとCIの差異を洗い出し、再現性ギャップを最小化。  
13. CIカバレッジ拡大（月次計画＋レポート）。  
14. トラブルシュートチェックリスト更新（再現手順・ログリンク標準化）。  
15. チャット共有テンプレ更新（CI結果ワンライナー）。  
16. Artifacts容量監視と自動クリーンアップ設定。  
17. 安定版/実験版ワークフロー整理（cron=安定版、dispatch=実験）。  
18. ベンチ自動比較・アラート強化（履歴をMarkdown/グラフで出力）。  
19. CIセキュリティ/権限（トークン/パーミッション）見直し。  
20. YAMLリファクタリング（重複削減・共通ステップ化）とコメント整備。

## Cチームタスク（ドキュメント/教材・長期）
1. chrono-2d README/Hands-onを月次更新し、最新Run IDとCSVサンプルを差し替え、Changelogに記録。  
2. Hands-onスクリプト運用ガイドを拡充（Run ID記録・CSV確認・リンクチェック・共有のショートカット）。  
3. Run ID貼付ワンライナーを各リポ向けに整備し、チャットテンプレに組み込み。  
4. 条件数/ピボット解説を表＋コマンド例で再構成し、即実行できる形式にする。  
5. 図版/スクショの命名・保存・参照ルールを確立し、追加時はREADMEリンクとChangelog追記を徹底。  
6. リンク/整合チェック手順を明記し、結果共有を運用に定着。  
7. 学習ステップチェックリストを拡張し、コマンド付きで自走できるようにする。  
8. 3D非対応/OpenMPのみの方針を強調し、定期キーワードチェックを運用に組み込む。  
9. CSVスキーマ説明とサンプル生成の手順をテンプレ化し、生成スクリプトで最新化。  
10. 命名ポリシーを短文化し、レビュー時の確認リストとして活用。  
11. Run ID区別ルールを統一し、abc_team_chat_handoff/git_setup/READMEで参照を同期。  
12. ドキュメントフォーマット統一と簡易Lintチェックを導入。  
13. 例題データセットの説明と更新手順をまとめ、学習者が差し替えやすいガイドを提供。  
14. アーカイブ方針（古いRun/ログの扱い）を明文化し、定期整理を実施。  
15. CI/運用ドキュメントへの導線をREADMEやハンドオフに追加し、更新時の連絡フローを簡潔にまとめる。  
16. Hands-onで得たRun ID/CSVの反映先とチェックリストを作成。  
17. 逸脱/異常時の連絡テンプレ（何を貼るか、どこに送るか）を整備。  
18. 用語・表記揺れガイドラインを作り、定期スキャンで修正を運用。  
19. スクショ/図版の格納場所と更新ルールを決め、定期差し替えサイクルを設定。  
20. Changelog運用を強化し、ドキュメント変更トリガー（リンク追加、図版更新、Run差し替え等）を明文化して遵守。
