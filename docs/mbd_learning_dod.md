# MBD 学習DoD（最終完成版向け）

最終更新: 2026-02-16  
オーナー: PM-3

## 1. 目的
- 本書は、最終完成版の FEM4C/Chrono 2D MBD を教材として使う際の学習到達基準（Definition of Done）を固定する。
- 前提は「現時点の実装状態」ではなく「最終完成版で学習する」ことである。

## 2. 学習者前提（固定）
- CAE の既存知識（例: Adams / Nastran / Marc）がある。
- C言語は初学者レベルである。
- 提供スクリプトは原則「実行用」ではなく「確認・参照用」に使う。

## 3. 学習DoD（2D-MBD）
以下を満たしたら「2D-MBD 実装を自力で再現可能」と判定する。

1. 状態量と拘束の理解
- 剛体状態 `q=[x,y,theta]`、拘束式、残差、ヤコビアンを説明できる。
- distance / revolute 拘束を数式とコード対応で追跡できる。

2. 最小実装の再現
- distance / revolute の残差とヤコビアンを自力で実装できる。
- 有限差分照合で導関数の妥当性を確認できる。

3. KKT 構成の理解
- body DOF とラグランジュ乗数 DOF を説明できる。
- 最小ケースで KKT レイアウトを構成し、未知量配置を追跡できる。

4. 時間積分の切替実装
- `Newmark-β` と `HHT-α` の2方式を実装し、実行時スイッチで切替できる。
- パラメータ境界、フォールバック、診断ログの意図を説明できる。

5. 入出力契約と診断
- parser 共通契約（FEM/MBD 共通の入力参照）を説明できる。
- 入力不備時の失敗理由（行番号・診断コード）を再現できる。

## 4. 3D への橋渡し（学習方針）
- 2D 学習内容は 3D の下地として有効である（拘束式、ヤコビアン、KKT、時間積分の本質は共通）。
- 3D 化で追加学習が必要な主要差分:
  - DOF 拡張（2D: 3 DOF / body -> 3D: 6 DOF / body）
  - 回転表現（単一角 -> 回転行列/クォータニオン）
  - 接触/摩擦モデルの拡張

## 5. ドキュメント作成ルール（必須）
- MBD 学習系ドキュメントを新規作成・更新する場合は、本書を必ず参照する。
- 追加文書には最低限、以下を含める:
  1. 数式 -> 変数 -> 関数 の対応表
  2. 最小実装ステップ
  3. 失敗時チェックポイント
  4. 2D から 3D へ拡張するときの注意点

