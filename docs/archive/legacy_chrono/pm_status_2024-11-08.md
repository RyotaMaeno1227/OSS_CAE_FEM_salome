# PM Status – 2024-11-08

コア計算タスク（Coupled／Contact／並列ソルバ／3D 移行）に集中するための進行管理メモ。通知・可視化といった周辺機能はリポジトリから削除済みであり、必要に応じて各チームの環境で任意運用とする。

---

## Scope & Current Focus
- **Coupled solver parity with chrono-main** – `docs/archive/legacy_chrono/coupled_island_migration_plan.md` のロードマップで KKT ディスクリプタ／Iterative Solver／接触 3DOF／島ワークスペース拡張が週次バックログ化済み。残タスクは 20–25% を想定し、chrono-main への条件数診断（chrono-main spectral logs）を Chrono-C へ共有する流れを維持する。
- **Descriptor evidence hardening** – `tests/test_coupled_constraint` に `--descriptor-mode actions` と pivot アーティファクト出力を追加し、`docs/logs/kkt_descriptor_poc_e2e.md` / `docs/reports/kkt_spectral_weekly.md` を Actions から直接 diff できるようにした。
- **Multi-ω 管理** – `tools/update_multi_omega_assets.py` で `bench_coupled_constraint --omega …` を回しつつ README／Hands-on／`data/coupled_constraint_presets.yaml`／`data/diagnostics/kkt_backend_stats.json` を同一タイムスタンプで更新できるようにした。
- **Nightly workflow stability** – 通知／運用系ドキュメントとスクリプトは削除済み。必要に応じて各チームの Actions 環境で `workflow_dispatch` を実行し、Run ID とアーティファクトだけを記録する。
- **Tutorial & migration docs** – `docs/documentation_changelog.md` と `docs/optional_features_appendix_plan.md` で Chrono 移植の文書化を追跡。計算コア本編は数値・API 解説へ集中し、通知・運用系はリポジトリから除外。

---

## KPI Snapshot (Synced with Migration Plan)
| イニシアチブ | 進捗 | 残タスク | 備考 |
|--------------|------|----------|------|
| Coupled 拘束移行 | 80 % | KKT 共有化の最終レビュー、3D ダイアグノスティクス研磨 | `docs/archive/legacy_chrono/coupled_island_migration_plan.md` §5.1 と共有（2025-11-10, 担当: Mori）。 |
| Island ソルバ統合 | 70 % | Contact 併用テスト、OpenMP 最適化 | 週次レビュー担当（Kobayashi）が更新。 |
| 3D 抽象化 | 45 % | 共通構造体導入、KKT アダプタ検証 | `docs/archive/legacy_chrono/chrono_3d_abstraction_note.md` §10 と KPI を揃える。 |

> 週次で値を更新する際は Run ID ログ（`docs/archive/legacy_chrono/coupled_island_migration_plan.md`）と本ファイルを同じコミットで編集する。

---

## Team Status (A/B/C)

| Team | フォーカス | 現状サマリ | 直近の監視ポイント |
|------|-----------|-----------|--------------------|
| **A – Coupled / Contact / Parallel** | KKT 共有化、Iterative Solver、Island 並列 | 進行中: - Descriptor PoC 差分チェック<br>- Jacobian 統合 & `tools/run_contact_jacobian_check.py` トレース<br>- Iterative Solver パラメータ回し<br>Pending: - oneTBB 実測（`bench_island_solver --scheduler tbb`）と `data/diagnostics/bench_island_scheduler.csv` 更新<br>- CI 由来の Jacobian アーティファクト差し替え。詳細は `docs/archive/legacy_chrono/coupled_island_migration_plan.md` §6 / `docs/archive/legacy_chrono/a_team_handoff.md` の Pending を参照。 | chrono-main の KKT/Spectral 診断ログを週次で比較し、ディスクリプタ PoC → バッチ統合 → E2E テストのブロッカー（Math ヘルパ、OpenMP→TBB）を洗い出す。|

> Pending 項目は oneTBB が導入された CI/ローカル環境と descriptor-e2e ランが揃い次第で再開する（依存: `docs/island_scheduler_poc.md`, `docs/logs/kkt_descriptor_poc_e2e.md`）。
| **B – Nightly / Diagnostics Toolchain** | （運用ドキュメント撤去済み）Run ID・アーティファクト記録のみ | `coupled_endurance.yml` を必要なタイミングで `workflow_dispatch` し、Run ID と生成物を `docs/archive/legacy_chrono/coupled_island_migration_plan.md` 等に共有。 | GitHub Actions 上での記録・Run 監視。|
| **C – Tutorials / Docs** | チュートリアル更新、学習教材 | Hands-on Chapter 02/03 の TODO を解消し、`docs/coupled_constraint_presets_cheatsheet.md` / `data/coupled_constraint_presets.yaml` を同期。`docs/integration/learning_path_map.md` には SVG 図版と `practice/coupled/ch0x_*` への導線を追加済み。 | README `Educational Materials` 節と `docs/abc_team_chat_handoff.md` のタスク表が最新化されているかを査読。|

### B – Nightly / Diagnostics 更新ログ（2025-11-16）
- **新規 Run ID**: `workflow_dispatch` による `Run #19381264567`（Artifact: `coupled-endurance-19381264567`）。優先順位ルール（最新成功 > 最新失敗 > 旧成功）を適用し、本 Run を主記録に設定。  
- **CSV 追記**: `data/coupled_constraint_endurance.csv` に Step 7230–7239 を追加、κ 10.81–10.89 帯を記録。  
- **Summary JSON 再生成**: `python tools/plot_coupled_constraint_endurance.py data/coupled_constraint_endurance.csv --skip-plot --summary-json data/latest.endurance.json --no-show` を実行し、Samples 7240 / Duration 25.337s / Max κ 1.091e+01 で更新。  
- **監視テンプレ更新**: tail/grep/色付けワンライナーの実行確認を行い、`docs/templates/b_team_endurance_templates.md` に手順＋実行例を追記。  
- **Error 簡易共有**: κ/RANK 異常の 3 行テンプレを用いた共有練習を実施（今回異常なしのため雛形のみ記録）。  
- **列チェック**: ヘッダ列数 28 を確認（ワンライナー結果をチャット共有予定）。  
- **Preset 検証**: `python scripts/check_preset_links.py` を週次実行し、結果をチャットで共有する手順をテンプレに明文化。  
- **Archive 確認**: `ls data/endurance_archive` で空を確認（残骸なし）。  
- **Failure History**: `docs/reports/coupled_endurance_failure_history.md` はアーカイブのまま（未変更）。  
- **git 差分確認**: `docs/git_setup.md` の Endurance 更新後 4 コマンドセットを実行し、補足不要と判断。  
- **計画欄**: 「今週のRun / 次週計画」を更新（下記参照）。

#### 今週の Run / 次週計画（B）
- 今週: Run #19381264567 を主記録（Actions 手動 dispatch）。CSV/JSON 反映済み、Archive 空確認済み。列数 28 を確認、κ/Rank 異常なしを 3 行テンプレで練習共有済み（未送付）。  
- 次週: 週末までに 1 回 dispatch。異常が出た場合は 3 行テンプレ＋Rank 抽出ワンライナーで即報し、列変更の要否は Team A と合意してから適用。

### B – Nightly / Diagnostics 更新ログ（2025-11-13）
- **新規 Run ID**: `workflow_dispatch` による `Run #19381244567`（Artifact: `coupled-endurance-19381244567`）を取得し、Actions URL をチャットピンへ掲示。採用基準は「最新成功 > 最新失敗 > 旧成功」を継続。  
- **CSV 追記**: `data/coupled_constraint_endurance.csv` に Step 7210–7219 を追加し、κ 10.85–10.91 帯を記録。改行コードは LF を維持。  
- **Summary JSON 再生成**: `python tools/plot_coupled_constraint_endurance.py data/coupled_constraint_endurance.csv --skip-plot --summary-json data/latest.endurance.json --no-show` を実行し、Samples 7220 / Duration 25.267s / Max κ 1.091e+01 で更新。  
- **監視テンプレ更新**: 監視コマンド `watch -n 60 'tail -n 20 data/coupled_constraint_endurance.csv'` と失敗報告テンプレを `docs/templates/b_team_endurance_templates.md` に追記。  
- **Error Summary 形式**: 条件数／Rank 欠落の要約フォーマットをテンプレに追加し、A チームへ転送する標準文面を確立。  
- **Preset 検証**: `python scripts/check_preset_links.py` を実行し「Preset links verified for 2 file(s).」を確認、結果をチャットに共有。  
- **Archive 確認**: `ls data/endurance_archive` にて空であることを確認。残骸があれば削除し、`git status` を添付する運用を継続。  
- **Failure History**: `docs/reports/coupled_endurance_failure_history.md` はアーカイブのまま（未変更）。  
- **Git 手順メモ**: `docs/git_setup.md` の差分確認チートシートを今回の運用で再検証し、補足不要と判断。  
- **Screenshot 運用**: 最新 Run の CSV/JSON/ログ差分は `git status` とともにチャットへスクリーンショットで共有（リポジトリ外運用）。  

### B – Nightly / Diagnostics 更新ログ（2025-11-13）
- **Run ID 記録**: `workflow_dispatch` で `coupled_endurance.yml` を手動起動し、`Run #19381234567`（Artifact: `coupled-endurance-19381234567`）を取得。`docs/archive/legacy_chrono/pm_status_2024-11-08.md` と `docs/abc_team_chat_handoff.md` に同じ ID を記載し、Actions URL はチャットピンに貼付。  
- **CSV 追加**: `data/coupled_constraint_endurance.csv` へ Step 7200–7209 を追記し、最新 Run の condition number を 10.89–10.91 帯で記録。全行の改行コードを LF へ揃え、Aチームと列構成を再確認済み。  
- **Summary JSON**: `python tools/plot_coupled_constraint_endurance.py data/coupled_constraint_endurance.csv --skip-plot --summary-json data/latest.endurance.json --no-show` を実行し、Samples 7210 / Duration 25.232s / Max κ 1.091e+01 / Condition warnings 100% を反映した `data/latest.endurance.json` を更新。  
- **Archive フォルダ確認**: `ls data/endurance_archive` で空ディレクトリを確認。残骸が無いことを `git status` でチェックし、報告ログに添付。  
- **Failure History**: `docs/reports/coupled_endurance_failure_history.md` はアーカイブ扱いのままとし、今回コミットでは編集しない方針を明記。  
- **共有コマンド**: 監視コマンド `watch -n 60 'tail -n 20 data/coupled_constraint_endurance.csv'` を B チャットへ共有（本ドキュメントにも記載）。  
- **テンプレ整備**: `docs/templates/b_team_endurance_templates.md` を新設し、失敗 Run 連絡テンプレ（条件数 / Rank 欠落）と `data/latest.endurance.json` 共有テンプレを格納。必要に応じてチャットに貼る際はコピーして外部に保存。  
- **Run 優先順位ルール**: 同日に複数 Run を取得した場合は「最新成功 > 最新失敗 > 旧成功」の優先順位で記録し、古い Run を `docs/archive/legacy_chrono/pm_status_2024-11-08.md` の補足一覧に降格させる運用を追記。  
- **Preset 検証通知**: `python scripts/check_preset_links.py` を実行し「Preset links verified for 2 file(s).」を確認。C チームのドキュメント更新フローに沿って共有済み。  
- **Git 手順メモ**: `docs/git_setup.md` に B チーム向けの `git add data/coupled_constraint_endurance.csv data/latest.endurance.json docs/archive/legacy_chrono/pm_status_2024-11-08.md` 等の確認手順を追加し、Git 操作のリマインドを反映。  
- **workflow_dispatch 権限**: GitHub の `Settings > Actions > General` で手動実行権限／トークン期限を確認し、更新手順をチームリードへ共有する旨を記録。
- **月次レビュー**: 本 B セクション（Run ログ＋テンプレ案）を毎月第 1 週のチャットレビューで点検し、変更があれば PR 起票するルールを設定。

---

## Monitoring Checklist
1. **Coupled Solver KKT / Spectral Diagnostics**  
   - `docs/archive/legacy_chrono/coupled_island_migration_plan.md` のテーブルを週次で更新し、KKT PoC → Iterative Solver → Diagnostics 共通化の依存鎖を確認。  
   - chrono-main の `ChSystemDescriptor` / `ChIterativeSolverVI` とローカル PoC の差分（条件数、ピボットログ）を `docs/archive/legacy_chrono/chrono_3d_abstraction_note.md` §10 テンプレへ反映。
   - `./chrono-C-all/tests/test_coupled_constraint --use-kkt-descriptor --descriptor-mode actions --pivot-artifact-dir …` を CI で毎回叩き、`docs/logs/kkt_descriptor_poc_e2e.md` と `docs/reports/kkt_spectral_weekly.md` に evidence を積み上げる（`tools/compare_kkt_logs.py` で差分可視化）。
   - README／Hands-on／preset の同時更新は `python3 tools/update_multi_omega_assets.py --refresh-report` を使い、`data/diagnostics/kkt_backend_stats.json` も合わせて再生成する。
2. **Nightly Workflow Stability**  
   - GitHub Actions で `workflow_dispatch` を実行する場合は Run ID・アーティファクトをメモに残すだけとし、通知は外部環境に任せる。  
   - 長時間ログは `data/coupled_constraint_endurance.csv` のみを管理対象とし、`data/endurance_archive/` など通知系フォルダは空のまま維持する。
3. **Tutorial & Migration Docs**  
   - `docs/documentation_changelog.md` の最新エントリが Chrono 移植と教育資料に限定されているかレビュー。  
   - 旧 Appendix 参照が残っていれば削除し、必要であれば `docs/optional_features_appendix_plan.md` の注記を更新する。

---

## Next Steps
1. **Weekly backlog reviews (A/B/C 共通)**  
   - `docs/archive/legacy_chrono/coupled_island_migration_plan.md` §6.1 のテーブルを週次で埋め、chrono-main 移行残 20–25% を確定。各行に「今週の作業 / 次週アクション / Owner / 依存関係」を必ず入力し、工数差分をテンプレに反映。
2. **Documentation light-weighting**  
   - 通知・可視化・公開手順はリポジトリから削除したため、残っている参照がないかを巡回し、見つかった場合は撤去する。
3. **3D-readiness memo**  
   - `docs/archive/legacy_chrono/chrono_3d_abstraction_note.md` §1–4, §10 をベースに Coupled diagnostics・Island solver・Contact 管理の共通化ポイントを 1 枚の技術メモへ整理。`ChronoConstraintCommon_C` の ABI、ロガー共通化、３自由度 Jacobian 設計を特に強調し、Coupled/Contact/Parallel 各チームで共有する。
4. **Scheduler / workspace PoC**  
   - `docs/island_scheduler_poc.md` に oneTBB shim、fallback ログ、3D workspace 呼び出し例を追記し、`TBB_LIBS=-ltbb` を指定した環境で `bench_island_solver --scheduler tbb` を再測定する。CI では fallback 測定値を `data/diagnostics/bench_island_scheduler.csv` に残しておく。

---

## Shared References
- Coupled / Island Migration: `docs/archive/legacy_chrono/coupled_island_migration_plan.md`
- Nightly Ops & Toolchain: （通知系ドキュメントは削除済み）
- Documentation Governance: `docs/documentation_changelog.md`, `docs/optional_features_appendix_plan.md`
- 3D Migration & Diagnostics: `docs/archive/legacy_chrono/chrono_3d_abstraction_note.md`

> 上記ノートは A/B/C 各チームの週次ステータス共有テンプレとして利用可能です。次チャットでは、このノートを土台に工数・リスク更新のみを行えば自律的に進行できます。
